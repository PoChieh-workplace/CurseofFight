tag @s add 1_splatus_actionbar_disabled
execute store result score distance refresh_count run scoreboard players get temp832 refresh_count

scoreboard players add distance refresh_count 4


execute as @e[type=!#vanilla_refresh:misc,distance=..5] store result score @s refresh_health run data get entity @s Health

#max health
execute as @e[type=!#vanilla_refresh:misc,tag=!refresh_entity_exists,distance=..5] at @s store result score @s refresh_maxhealth run data get entity @s Health

execute as @e[type=!#vanilla_refresh:misc,tag=!refresh_entity_exists,distance=..5] at @s run tag @s add refresh_entity_exists


tag @s add refresh_spyglass 
execute as @e[distance=0.0..1.5,type=!#vanilla_refresh:misc_spyglass,tag=!refresh_entity_misc,sort=nearest,limit=1] as @s[type=villager] run function vanilla_refresh:entity/mob_health/spyglass_villager
execute as @e[distance=0.0..1.5,type=!#vanilla_refresh:misc_spyglass,tag=!refresh_entity_misc,sort=nearest,limit=1,gamemode=!spectator] if entity @s[type=player] run title @p[tag=!1_splatus_actionbar_disabled_2,tag=refresh_spyglass] actionbar [{"translate":"","color": "yellow"},{"selector":"@e[distance=0.1..1.5,type=!#vanilla_refresh:misc_spyglass,tag=!refresh_entity_misc,sort=nearest,limit=1]"},{"translate": " - ","color": "gray"},{"translate":"vanillarefresh.entity_type","color":"light_purple"},{"translate":"vanillarefresh.player","color": "yellow"},{"translate": " - ","color": "gray"},{"translate": "vanillarefresh.health","color":"red"},{"score":{"name": "@e[distance=0.1..5,type=!#vanilla_refresh:misc_spyglass,tag=!refresh_entity_misc,sort=nearest,limit=1]","objective": "refresh_health"}},{"translate": "/"},{"score":{"name": "@e[distance=0.1..5,type=!#vanilla_refresh:misc_spyglass,tag=!refresh_entity_misc,sort=nearest,limit=1]","objective": "refresh_maxhealth"}},{"translate": " - ","color": "gray"},{"translate": "vanillarefresh.distance","color":"dark_blue"},{"score":{"name": "distance","objective": "refresh_count"}},{"translate": "vanillarefresh.blocks_away"}]
execute as @e[distance=0.0..1.5,type=!#vanilla_refresh:misc_spyglass,tag=!refresh_entity_misc,sort=nearest,limit=1] if entity @s[type=!#vanilla_refresh:misc,type=!player,type=!villager] run title @p[tag=!1_splatus_actionbar_disabled_2,tag=refresh_spyglass] actionbar [{"translate":"","color": "yellow"},{"selector":"@e[distance=0.1..1.5,type=!#vanilla_refresh:misc_spyglass,tag=!refresh_entity_misc,sort=nearest,limit=1]","color": "green"},{"translate": " - ","color": "gray"},{"translate":"vanillarefresh.entity_type","color":"light_purple"},{"translate":"vanillarefresh.entity","color": "yellow"},{"translate": " - ","color": "gray"},{"translate": "vanillarefresh.health","color":"red"},{"score":{"name": "@e[distance=0.1..5,type=!#vanilla_refresh:misc_spyglass,tag=!refresh_entity_misc,sort=nearest,limit=1]","objective": "refresh_health"}},{"translate": "/"},{"score":{"name": "@e[distance=0.1..5,type=!#vanilla_refresh:misc_spyglass,tag=!refresh_entity_misc,sort=nearest,limit=1]","objective": "refresh_maxhealth"}},{"translate": " - ","color": "gray"},{"translate": "vanillarefresh.distance","color":"dark_blue"},{"score":{"name": "distance","objective": "refresh_count"}},{"translate": "vanillarefresh.blocks_away"}]
execute as @e[distance=0.0..1.5,type=!#vanilla_refresh:misc_spyglass,tag=!refresh_entity_misc,sort=nearest,limit=1] if entity @s[type=#vanilla_refresh:misc] run title @p[tag=!1_splatus_actionbar_disabled_2,tag=refresh_spyglass] actionbar [{"translate":"","color": "yellow"},{"selector":"@e[distance=0.1..1.5,type=!#vanilla_refresh:misc_spyglass,tag=!refresh_entity_misc,sort=nearest,limit=1]","color": "green"},{"translate": " - ","color": "gray"},{"translate":"vanillarefresh.entity_type","color":"light_purple"},{"translate":"Miscellaneous","color": "yellow"},{"translate": " - ","color": "gray"},{"translate": "vanillarefresh.distance","color":"dark_blue"},{"score":{"name": "distance","objective": "refresh_count"}},{"translate": "vanillarefresh.blocks_away"}]
execute as @e[distance=0.0..5,type=ender_dragon] if data entity @s DragonPhase run title @p[tag=!1_splatus_actionbar_disabled_2,tag=refresh_spyglass] actionbar [{"translate":"","color": "yellow"},{"selector":"@s","color": "green"},{"translate": " - ","color": "gray"},{"translate":"vanillarefresh.entity_type","color":"light_purple"},{"translate":"Boss","color": "yellow"},{"translate": " - ","color": "gray"},{"translate": "vanillarefresh.health","color":"red"},{"score":{"name": "@s","objective": "refresh_health"}},{"translate": "/"},{"score":{"name": "@s","objective": "refresh_maxhealth"}},{"translate": " - ","color": "gray"},{"translate": "vanillarefresh.distance","color":"dark_blue"},{"score":{"name": "distance","objective": "refresh_count"}},{"translate": "vanillarefresh.blocks_away"}]
execute as @e[distance=0.0..3,type=wither,sort=nearest,limit=1] run title @p[tag=!1_splatus_actionbar_disabled_2,tag=refresh_spyglass] actionbar [{"translate":"","color": "yellow"},{"selector":"@s","color": "green"},{"translate": " - ","color": "gray"},{"translate":"vanillarefresh.entity_type","color":"light_purple"},{"translate":"Boss","color": "yellow"},{"translate": " - ","color": "gray"},{"translate": "vanillarefresh.health","color":"red"},{"score":{"name": "@s","objective": "refresh_health"}},{"translate": "/"},{"score":{"name": "@s","objective": "refresh_maxhealth"}},{"translate": " - ","color": "gray"},{"translate": "vanillarefresh.distance","color":"dark_blue"},{"score":{"name": "distance","objective": "refresh_count"}},{"translate": "vanillarefresh.blocks_away"}]

scoreboard players reset distance refresh_count

tag @s remove refresh_spyglass